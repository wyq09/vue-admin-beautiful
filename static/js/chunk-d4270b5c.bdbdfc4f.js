/*!
 *  基于vue-admin-beautiful构建 
 *  copyright: chuzhixin 1204505056@qq.com 
 *  time: 2020-7-2 12:48:39
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d4270b5c"],{1940:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"slide-verify",attrs:{id:"slideVerify",onselectstart:"return false;"}},[e("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:t.w,height:t.h}}),e("div",{staticClass:"slide-verify-refresh-icon",on:{click:t.refresh}}),e("canvas",{ref:"block",staticClass:"slide-verify-block",attrs:{width:t.w,height:t.h}}),e("div",{staticClass:"slide-verify-slider",class:{"container-active":t.containerActive,"container-success":t.containerSuccess,"container-fail":t.containerFail}},[e("div",{staticClass:"slide-verify-slider-mask",style:{width:t.sliderMaskWidth}},[e("div",{staticClass:"slide-verify-slider-mask-item",style:{left:t.sliderLeft},on:{mousedown:t.sliderDown,touchstart:t.touchStartEvent,touchmove:t.touchMoveEvent,touchend:t.touchEndEvent}},[e("i",{staticClass:"el-icon-arrow-right"})])]),e("span",{staticClass:"slide-verify-slider-text"},[t._v(t._s(t.sliderText))])])])},n=[],r=(e("2eeb"),e("1784"),e("513c"),Math.PI);function o(t,i){return t+i}function a(t){return t*t}var c={name:"Verify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"}},data:function(){return{containerActive:!1,containerSuccess:!1,containerFail:!1,canvasCtx:null,blockCtx:null,block:null,block_x:void 0,block_y:void 0,L:this.l+2*this.r+3,img:void 0,originX:void 0,originY:void 0,isMouseDown:!1,trail:[],sliderLeft:0,sliderMaskWidth:0}},mounted:function(){this.init()},methods:{init:function(){this.initDom(),this.initImg(),this.bindEvents()},initDom:function(){this.block=this.$refs.block,this.canvasCtx=this.$refs.canvas.getContext("2d"),this.blockCtx=this.block.getContext("2d")},initImg:function(){var t=this,i=this.createImg((function(){t.drawBlock(),t.canvasCtx.drawImage(i,0,0,t.w,t.h),t.blockCtx.drawImage(i,0,0,t.w,t.h);var e=t.block_x,s=t.block_y,n=t.r,r=t.L,o=s-2*n-1,a=t.blockCtx.getImageData(e,o,r,r);t.block.width=r,t.blockCtx.putImageData(a,0,o)}));this.img=i},drawBlock:function(){this.block_x=this.getRandomNumberByRange(this.L+10,this.w-(this.L+10)),this.block_y=this.getRandomNumberByRange(10+2*this.r,this.h-(this.L+10)),this.draw(this.canvasCtx,this.block_x,this.block_y,"fill"),this.draw(this.blockCtx,this.block_x,this.block_y,"clip")},draw:function(t,i,e,s){var n=this.l,o=this.r;t.beginPath(),t.moveTo(i,e),t.arc(i+n/2,e-o+2,o,.72*r,2.26*r),t.lineTo(i+n,e),t.arc(i+n+o-2,e+n/2,o,1.21*r,2.78*r),t.lineTo(i+n,e+n),t.lineTo(i,e+n),t.arc(i+o-2,e+n/2,o+.4,2.76*r,1.24*r,!0),t.lineTo(i,e),t.lineWidth=2,t.fillStyle="rgba(255, 255, 255, 0.8)",t.strokeStyle="rgba(255, 255, 255, 0.8)",t.stroke(),t[s](),t.globalCompositeOperation="xor"},createImg:function(t){var i=this,e=document.createElement("img");return e.crossOrigin="Anonymous",e.onload=t,e.onerror=function(){e.src=i.getRandomImg()},e.src=this.getRandomImg(),e},getRandomImg:function(){return"https://picsum.photos/350/170/?image="+this.getRandomNumberByRange(0,50)},getRandomNumberByRange:function(t,i){return Math.round(Math.random()*(i-t)+t)},refresh:function(){this.reset(),this.$emit("refresh")},sliderDown:function(t){this.originX=t.clientX,this.originY=t.clientY,this.isMouseDown=!0},touchStartEvent:function(t){this.originX=t.changedTouches[0].pageX,this.originY=t.changedTouches[0].pageY,this.isMouseDown=!0},bindEvents:function(){var t=this;document.addEventListener("mousemove",(function(i){if(!t.isMouseDown)return!1;var e=i.clientX-t.originX,s=i.clientY-t.originY;if(e<0||e+38>=t.w)return!1;t.sliderLeft=e+"px";var n=(t.w-40-20)/(t.w-40)*e;t.block.style.left=n+"px",t.containerActive=!0,t.sliderMaskWidth=e+"px",t.trail.push(s)})),document.addEventListener("mouseup",(function(i){if(!t.isMouseDown)return!1;if(t.isMouseDown=!1,i.clientX===t.originX)return!1;t.containerActive=!1;var e=t.verify(),s=e.spliced,n=e.TuringTest;s?n?(t.containerSuccess=!0,t.$emit("success")):(t.containerFail=!0,t.sliderText="try again",t.reset()):(t.containerFail=!0,t.$emit("fail"),setTimeout((function(){t.reset()}),1e3))}))},touchMoveEvent:function(t){if(!this.isMouseDown)return!1;var i=t.changedTouches[0].pageX-this.originX,e=t.changedTouches[0].pageY-this.originY;if(i<0||i+38>=this.w)return!1;this.sliderLeft=i+"px";var s=(this.w-40-20)/(this.w-40)*i;this.block.style.left=s+"px",this.containerActive=!0,this.sliderMaskWidth=i+"px",this.trail.push(e)},touchEndEvent:function(t){var i=this;if(!this.isMouseDown)return!1;if(this.isMouseDown=!1,t.changedTouches[0].pageX===this.originX)return!1;this.containerActive=!1;var e=this.verify(),s=e.spliced,n=e.TuringTest;s?n?(this.containerSuccess=!0,this.$emit("success")):(this.containerFail=!0,this.sliderText="try again",this.reset()):(this.containerFail=!0,this.$emit("fail"),setTimeout((function(){i.reset()}),1e3))},verify:function(){var t=this.trail,i=t.reduce(o)/t.length,e=t.map((function(t){return t-i})),s=Math.sqrt(e.map(a).reduce(o)/t.length),n=parseInt(this.block.style.left);return{spliced:Math.abs(n-this.block_x)<10,TuringTest:i!==s}},reset:function(){this.containerActive=!1,this.containerSuccess=!1,this.containerFail=!1,this.sliderLeft=0,this.block.style.left=0,this.sliderMaskWidth=0;var t=this.w,i=this.h;this.canvasCtx.clearRect(0,0,t,i),this.blockCtx.clearRect(0,0,t,i),this.block.width=t,this.img.src=this.getRandomImg()}}},l=c,h=(e("c07f"),e("9ca4")),u=Object(h["a"])(l,s,n,!1,null,"2030f594",null),d=u.exports,f=d;"undefined"!==typeof window&&window.Vue&&window.Vue.component("zx-verify",d);i["default"]=f},5798:function(t,i,e){},c07f:function(t,i,e){"use strict";var s=e("5798"),n=e.n(s);n.a},e808:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"verify-container"},[e("vab-verify",{ref:"slideDiv",attrs:{w:350,"slider-text":t.text,h:175},on:{success:t.handleSuccess,fail:t.handleError}})],1)},n=[],r=e("1940"),o={name:"Verify",components:{VabVerify:r["default"]},data:function(){return{text:"向右滑动"}},created:function(){},mounted:function(){},methods:{handleSuccess:function(){this.$baseMessage("校验成功","success")},handleError:function(){this.$baseMessage("校验失败","error")}}},a=o,c=e("9ca4"),l=Object(c["a"])(a,s,n,!1,null,null,null);i["default"]=l.exports}}]);